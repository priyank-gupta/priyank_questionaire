
<% unless params[:level].select {|a,b| !b.empty? }.empty? %>
  <% questions, beg, int, mast = count_questions_by_level(@questions.dup, params[:level]) %>
<% else %>
  <% questions = @questions %>
<% end %>

<% params[:level].each do |l_i, l| %>
    <% unless l.empty? %>
      <% if l_i == "0" && l > beg.to_s %>
        <span class = "error">Beginner:: <%= beg.to_s+"/"+l %> &nbsp;&nbsp; </span>
      <% end %>
      <% if l_i == "1" && l > int.to_s %>
        <span class = "error">Intermediate:: <%= int.to_s+"/"+l %> &nbsp;&nbsp; </span>
      <% end %>
      <% if l_i == "2" && l > mast.to_s %>
        <span class = "error">Master:: <%= mast.to_s+"/"+l %> &nbsp;&nbsp; </span>
      <% end %>
    <% end %>
<% end %>

<h2 align ="center"><%= params[:name] %></h2>

<% unless params[:instructions].empty? %>
  <p style="margin-bottom:0"><b>Instructions::</b>
    <p style="margin-top:2px">
      <% params[:instructions].split(/\n/).each do |inst| %>
        <%= inst %><br/>
      <% end %>
    </p>
  </p>
<% end %>

<% unless questions.empty? %>
  <% questions.each_with_index do |question, index| %>
    <div class = "show_question <%= cycle('list_line_odd', 'list_line_even') %>" style="padding:5px">
      <p class = "title_ques" style = "float:left;margin:0"><b><%= index+1 %>. </b><%= question.body %></p>
      <div style="float:right">
        <%= link_to 'Show', show_fetch_ques_questions_path(question), :rel => "facebox" %>
      </div><br/>
    </div>
  <% end %>
<% end %>

<% make_doc(params[:name], params[:instructions], questions, params[:sets]) %>

<div align="center">
  <% test_name = params[:name].gsub(/\s+/,"_") %>
  <%= link_to "Download Sets", download_questions_path(test_name) %>
</div>

<script>
jQuery(document).ready(function($) {
  $('a[rel*=facebox]').facebox()
})
</script>
